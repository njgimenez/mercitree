{"ast":null,"code":"var _jsxFileName = \"/home/devdisnovo/Documentos/PROYECTOS/merci/client/src/components/PDFGenerator.tsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport { motion } from 'framer-motion';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PDFGenerator = ({\n  votos,\n  estadisticas,\n  treeRef\n}) => {\n  _s();\n  const [generating, setGenering] = React.useState(false);\n\n  // Utilidad: carga una imagen en alta resolución\n  const loadImage = src => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      img.onload = () => resolve(img);\n      img.onerror = reject;\n      img.src = src;\n    });\n  };\n\n  // Utilidad: crea una imagen circular de alta calidad\n  const createCircularImageDataUrl = async (src, size) => {\n    try {\n      const img = await loadImage(src);\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n\n      // Usar alta resolución para evitar pixelación\n      const scale = 2;\n      const scaledSize = size * scale;\n      canvas.width = scaledSize;\n      canvas.height = scaledSize;\n      if (!ctx) return '';\n\n      // Configurar para alta calidad\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = 'high';\n      ctx.clearRect(0, 0, scaledSize, scaledSize);\n      ctx.save();\n      ctx.beginPath();\n      ctx.arc(scaledSize / 2, scaledSize / 2, scaledSize / 2, 0, Math.PI * 2, true);\n      ctx.closePath();\n      ctx.clip();\n\n      // Calcular dimensiones para mantener aspecto y llenar el círculo\n      const imgAspect = img.width / img.height;\n      let drawWidth = scaledSize;\n      let drawHeight = scaledSize;\n      let offsetX = 0;\n      let offsetY = 0;\n      if (imgAspect > 1) {\n        // Imagen más ancha que alta\n        drawHeight = scaledSize;\n        drawWidth = drawHeight * imgAspect;\n        offsetX = -(drawWidth - scaledSize) / 2;\n      } else {\n        // Imagen más alta que ancha\n        drawWidth = scaledSize;\n        drawHeight = drawWidth / imgAspect;\n        offsetY = -(drawHeight - scaledSize) / 2;\n      }\n      ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);\n      ctx.restore();\n      return canvas.toDataURL('image/png');\n    } catch (error) {\n      console.log('Error creating circular image:', error);\n      return '';\n    }\n  };\n\n  // Utilidad: truncar texto que no cabe en el ancho disponible\n  const truncateText = (pdf, text, maxWidth, fontSize) => {\n    pdf.setFontSize(fontSize);\n    const textWidth = pdf.getTextWidth(text);\n    if (textWidth <= maxWidth) {\n      return text;\n    }\n\n    // Truncar y agregar \"...\"\n    let truncated = text;\n    while (pdf.getTextWidth(truncated + '...') > maxWidth && truncated.length > 1) {\n      truncated = truncated.slice(0, -1);\n    }\n    return truncated + '...';\n  };\n  const generatePDF = async () => {\n    if (!treeRef.current) return;\n    setGenering(true);\n    try {\n      const pdf = new jsPDF('p', 'mm', 'a4');\n      const pageWidth = pdf.internal.pageSize.getWidth();\n      const pageHeight = pdf.internal.pageSize.getHeight();\n\n      // Usar fuente Helvetica (más legible que la default)\n      pdf.setFont('helvetica');\n\n      // Página 1: Portada con encabezado\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n\n      // Encabezado principal con mejor tipografía\n      pdf.setFontSize(22);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('🌿 Árbol de Predicciones', pageWidth / 2, 25, {\n        align: 'center'\n      });\n      pdf.setFontSize(16);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Un Recuerdo Especial', pageWidth / 2, 35, {\n        align: 'center'\n      });\n\n      // Capturar imagen del árbol en alta calidad\n      const treeCanvas = await html2canvas(treeRef.current, {\n        scale: 2,\n        // Mayor escala para mejor calidad\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        logging: false,\n        width: treeRef.current.offsetWidth,\n        height: treeRef.current.offsetHeight\n      });\n      const treeImgData = treeCanvas.toDataURL('image/png');\n      const treeAspectRatio = treeCanvas.width / treeCanvas.height;\n      const treeWidth = pageWidth - 40;\n      const treeHeight = treeWidth / treeAspectRatio;\n\n      // Agregar imagen del árbol centrada\n      pdf.addImage(treeImgData, 'PNG', 20, 50, treeWidth, treeHeight);\n\n      // Fecha de generación\n      pdf.setFontSize(12);\n      pdf.setTextColor(153, 153, 153);\n      pdf.setFont('helvetica', 'normal');\n      const fecha = new Date().toLocaleDateString('es-ES', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n      pdf.text(`Generado el ${fecha}`, pageWidth / 2, pageHeight - 20, {\n        align: 'center'\n      });\n\n      // Página 2: Estadísticas en tarjetas modernas\n      pdf.addPage();\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n\n      // Título de estadísticas\n      pdf.setFontSize(20);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('Estadísticas de las Predicciones', pageWidth / 2, 30, {\n        align: 'center'\n      });\n\n      // Dibujar tarjetas de estadísticas modernas\n      const cardWidthStats = 55;\n      const cardHeightStats = 35;\n      const startX = (pageWidth - (cardWidthStats * 3 + 20)) / 2;\n\n      // Tarjeta Total\n      pdf.setFillColor(255, 255, 255);\n      pdf.setDrawColor(230, 230, 230);\n      pdf.setLineWidth(0.5);\n      pdf.roundedRect(startX, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(102, 126, 234);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.total_votos.toString(), startX + cardWidthStats / 2, 65, {\n        align: 'center'\n      });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Total Votos', startX + cardWidthStats / 2, 75, {\n        align: 'center'\n      });\n\n      // Tarjeta Niño\n      pdf.setFillColor(255, 255, 255);\n      pdf.roundedRect(startX + cardWidthStats + 10, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(30, 64, 175);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.votos_varon.toString(), startX + cardWidthStats + 10 + cardWidthStats / 2, 65, {\n        align: 'center'\n      });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Niño', startX + cardWidthStats + 10 + cardWidthStats / 2, 75, {\n        align: 'center'\n      });\n\n      // Tarjeta Niña\n      pdf.setFillColor(255, 255, 255);\n      pdf.roundedRect(startX + (cardWidthStats + 10) * 2, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(190, 24, 93);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.votos_nina.toString(), startX + (cardWidthStats + 10) * 2 + cardWidthStats / 2, 65, {\n        align: 'center'\n      });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Niña', startX + (cardWidthStats + 10) * 2 + cardWidthStats / 2, 75, {\n        align: 'center'\n      });\n\n      // Porcentajes en círculos pequeños\n      pdf.setFontSize(12);\n      const porcentajeNino = Math.round(estadisticas.votos_varon / estadisticas.total_votos * 100);\n      const porcentajeNina = Math.round(estadisticas.votos_nina / estadisticas.total_votos * 100);\n\n      // Círculo para niño\n      pdf.setFillColor(212, 240, 247);\n      pdf.circle(startX + cardWidthStats + 10 + cardWidthStats / 2, 90, 8, 'F');\n      pdf.setTextColor(30, 64, 175);\n      pdf.setFontSize(10);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(`${porcentajeNino}%`, startX + cardWidthStats + 10 + cardWidthStats / 2, 93, {\n        align: 'center'\n      });\n\n      // Círculo para niña\n      pdf.setFillColor(250, 218, 221);\n      pdf.circle(startX + (cardWidthStats + 10) * 2 + cardWidthStats / 2, 90, 8, 'F');\n      pdf.setTextColor(190, 24, 93);\n      pdf.text(`${porcentajeNina}%`, startX + (cardWidthStats + 10) * 2 + cardWidthStats / 2, 93, {\n        align: 'center'\n      });\n\n      // Filtrar comentarios válidos\n      const comentariosValidos = votos.filter(voto => voto.comentario && voto.comentario.trim().length > 0 && voto.comentario.trim() !== 'undefined' && voto.comentario.trim() !== 'null');\n      if (comentariosValidos.length > 0) {\n        // Página 3+: Comentarios en rejilla de 3 columnas\n        pdf.addPage();\n        pdf.setFillColor(248, 250, 252);\n        pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n\n        // Título de la página\n        pdf.setFontSize(20);\n        pdf.setTextColor(51, 51, 51);\n        pdf.setFont('helvetica', 'bold');\n        pdf.text('Mensajes Especiales', pageWidth / 2, 25, {\n          align: 'center'\n        });\n\n        // Configuración de la rejilla\n        const marginX = 15;\n        const marginY = 40;\n        const cardWidth = (pageWidth - marginX * 2 - 20) / 3;\n        const cardHeight = 75;\n        const cardSpacing = 10;\n        let currentRow = 0;\n        let currentCol = 0;\n        let pageCount = 3;\n        for (let index = 0; index < comentariosValidos.length; index++) {\n          var _voto$nombre;\n          const voto = comentariosValidos[index];\n\n          // Verificar si necesitamos nueva página\n          const currentY = marginY + currentRow * (cardHeight + cardSpacing);\n          if (currentY + cardHeight > pageHeight - 30) {\n            pdf.addPage();\n            pdf.setFillColor(248, 250, 252);\n            pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n            pdf.setFontSize(20);\n            pdf.setTextColor(51, 51, 51);\n            pdf.setFont('helvetica', 'bold');\n            pdf.text(`Mensajes Especiales (Página ${pageCount})`, pageWidth / 2, 25, {\n              align: 'center'\n            });\n            currentRow = 0;\n            currentCol = 0;\n            pageCount++;\n          }\n          const cardX = marginX + currentCol * (cardWidth + 10);\n          const cardY = marginY + currentRow * (cardHeight + cardSpacing);\n\n          // Dibujar card con estilo moderno\n          pdf.setFillColor(255, 255, 255);\n          pdf.setDrawColor(230, 230, 230);\n          pdf.setLineWidth(0.5);\n          pdf.roundedRect(cardX, cardY, cardWidth, cardHeight, 8, 8, 'FD');\n\n          // Agregar sombra sutil\n          pdf.setDrawColor(200, 200, 200);\n          pdf.setLineWidth(0.3);\n          pdf.roundedRect(cardX + 1, cardY + 1, cardWidth, cardHeight, 8, 8, 'S');\n\n          // Bandera de alta calidad si hay país\n          const pais = (voto.pais || '').toString().toLowerCase();\n          let nombreOffsetX = 8;\n          if (pais && pais.length === 2) {\n            try {\n              // Usar URL de bandera de mayor resolución\n              const flagUrl = `https://flagcdn.com/48x36/${pais}.png`;\n              const flagImg = await loadImage(flagUrl);\n              // Tamaño ligeramente mayor para mejor calidad\n              pdf.addImage(flagImg, 'PNG', cardX + 8, cardY + 6, 14, 10.5);\n              nombreOffsetX = 8 + 14 + 4;\n            } catch (e) {\n              // Ignorar si falla la bandera\n            }\n          }\n\n          // Limpiar y truncar el nombre si es muy largo\n          let nombreLimpio = ((_voto$nombre = voto.nombre) === null || _voto$nombre === void 0 ? void 0 : _voto$nombre.toString().trim()) || 'Anónimo';\n          if (nombreLimpio === 'undefined' || nombreLimpio === 'null') nombreLimpio = 'Anónimo';\n\n          // Calcular ancho disponible para el nombre\n          const anchoDisponible = cardWidth - nombreOffsetX - 8;\n          const nombreTruncado = truncateText(pdf, nombreLimpio, anchoDisponible, 11);\n\n          // Nombre\n          pdf.setFontSize(11);\n          pdf.setTextColor(51, 51, 51);\n          pdf.setFont('helvetica', 'bold');\n          pdf.text(nombreTruncado, cardX + nombreOffsetX, cardY + 12);\n\n          // Etiqueta de género\n          pdf.setFontSize(9);\n          pdf.setFont('helvetica', 'normal');\n          if (voto.prediccion === 'varon') {\n            pdf.setFillColor(212, 240, 247);\n            pdf.roundedRect(cardX + 8, cardY + 20, 30, 8, 4, 4, 'F');\n            pdf.setTextColor(30, 64, 175);\n            pdf.text('👦 Niño', cardX + 10, cardY + 25);\n          } else {\n            pdf.setFillColor(250, 218, 221);\n            pdf.roundedRect(cardX + 8, cardY + 20, 30, 8, 4, 4, 'F');\n            pdf.setTextColor(190, 24, 93);\n            pdf.text('👧 Niña', cardX + 10, cardY + 25);\n          }\n\n          // Comentario centrado\n          let comentarioLimpio = voto.comentario || 'Sin comentario';\n          comentarioLimpio = comentarioLimpio.toString().trim();\n          if (comentarioLimpio === 'undefined' || comentarioLimpio === 'null') comentarioLimpio = 'Sin comentario';\n          pdf.setFontSize(9);\n          pdf.setTextColor(55, 65, 81);\n          pdf.setFont('helvetica', 'normal');\n          const comentario = `\"${comentarioLimpio}\"`;\n          const lines = pdf.splitTextToSize(comentario, cardWidth - 20);\n          const textHeight = lines.length * 4;\n          const startTextY = cardY + 36 + Math.max(0, (cardHeight - 36 - textHeight - 12) / 2);\n          lines.forEach((line, lineIndex) => {\n            pdf.text(line, cardX + cardWidth / 2, startTextY + lineIndex * 4, {\n              align: 'center'\n            });\n          });\n\n          // Fecha inferior\n          pdf.setFontSize(8);\n          pdf.setTextColor(156, 163, 175);\n          let fechaTexto = 'Fecha no disponible';\n          try {\n            const raw = (voto.fecha_voto || voto.fecha || '').toString();\n            if (raw) {\n              const f = new Date(raw);\n              if (!isNaN(f.getTime())) {\n                const fechaVoto = f.toLocaleDateString('es-ES', {\n                  day: '2-digit',\n                  month: 'short',\n                  year: 'numeric'\n                });\n                const horaVoto = f.toLocaleTimeString('es-ES', {\n                  hour: '2-digit',\n                  minute: '2-digit'\n                });\n                fechaTexto = `${fechaVoto}, ${horaVoto}`;\n              }\n            }\n          } catch {}\n          pdf.text(fechaTexto, cardX + 8, cardY + cardHeight - 6);\n\n          // Foto circular de alta calidad\n          if (voto.foto_url) {\n            try {\n              const size = 22; // Ligeramente más grande\n              const dataUrl = await createCircularImageDataUrl(`http://192.168.18.49:5000${voto.foto_url}`, size * 2);\n              if (dataUrl) {\n                const fotoX = cardX + cardWidth - size - 6;\n                const fotoY = cardY + 6;\n                pdf.addImage(dataUrl, 'PNG', fotoX, fotoY, size, size);\n                // Borde circular\n                pdf.setDrawColor(230, 230, 230);\n                pdf.setLineWidth(0.5);\n                pdf.circle(fotoX + size / 2, fotoY + size / 2, size / 2, 'S');\n              }\n            } catch {\n              // Placeholder más bonito\n              const size = 22;\n              const fotoX = cardX + cardWidth - size - 6;\n              const fotoY = cardY + 6;\n              pdf.setFillColor(243, 244, 246);\n              pdf.circle(fotoX + size / 2, fotoY + size / 2, size / 2, 'F');\n              pdf.setDrawColor(209, 213, 219);\n              pdf.setLineWidth(0.5);\n              pdf.circle(fotoX + size / 2, fotoY + size / 2, size / 2, 'S');\n              // Icono de usuario\n              pdf.setTextColor(156, 163, 175);\n              pdf.setFontSize(8);\n              pdf.text('👤', fotoX + size / 2, fotoY + size / 2 + 2, {\n                align: 'center'\n              });\n            }\n          }\n\n          // Avanzar a la siguiente posición en la rejilla\n          currentCol++;\n          if (currentCol >= 3) {\n            currentCol = 0;\n            currentRow++;\n          }\n        }\n      }\n\n      // Página final: Mensaje especial destacado\n      pdf.addPage();\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n\n      // Título principal\n      pdf.setFontSize(24);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('¡Felicidades Futuros Padres!', pageWidth / 2, 50, {\n        align: 'center'\n      });\n\n      // Card destacada para el mensaje final\n      const finalCardWidth = pageWidth - 40;\n      const finalCardHeight = 120;\n      const finalCardX = 20;\n      const finalCardY = 70;\n\n      // Fondo de la card\n      pdf.setFillColor(255, 255, 255);\n      pdf.setDrawColor(230, 230, 230);\n      pdf.setLineWidth(1);\n      pdf.roundedRect(finalCardX, finalCardY, finalCardWidth, finalCardHeight, 12, 12, 'FD');\n\n      // Borde decorativo\n      pdf.setDrawColor(102, 126, 234);\n      pdf.setLineWidth(2);\n      pdf.roundedRect(finalCardX, finalCardY, finalCardWidth, finalCardHeight, 12, 12, 'S');\n\n      // Mensaje final\n      pdf.setFontSize(14);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'normal');\n      const mensajeFinal = ['Este árbol representa el amor y las buenas vibras que', 'toda su familia y amigos tienen para ustedes.', '', 'Cada hoja es una predicción llena de cariño y', 'esperanza para el nuevo miembro de la familia.', '', '¡Que este bebé traiga mucha alegría y bendiciones', 'a sus vidas!'];\n      mensajeFinal.forEach((line, index) => {\n        if (line.trim() !== '') {\n          pdf.text(line, pageWidth / 2, finalCardY + 25 + index * 12, {\n            align: 'center'\n          });\n        }\n      });\n\n      // Firma\n      pdf.setFontSize(12);\n      pdf.setTextColor(102, 126, 234);\n      pdf.setFont('helvetica', 'italic');\n      pdf.text('Con mucho amor y buenos deseos', pageWidth / 2, finalCardY + finalCardHeight + 20, {\n        align: 'center'\n      });\n\n      // Guardar el PDF\n      pdf.save('arbol-predicciones-recuerdo-especial.pdf');\n    } catch (error) {\n      console.error('Error generando PDF:', error);\n      alert('Error al generar el PDF. Inténtalo de nuevo.');\n    } finally {\n      setGenering(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(motion.button, {\n    onClick: generatePDF,\n    disabled: generating,\n    whileHover: {\n      scale: 1.05\n    },\n    whileTap: {\n      scale: 0.95\n    },\n    style: {\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      color: 'white',\n      border: 'none',\n      borderRadius: '15px',\n      padding: '18px 30px',\n      fontSize: '1.1rem',\n      fontWeight: '600',\n      cursor: generating ? 'not-allowed' : 'pointer',\n      width: '100%',\n      marginTop: '20px',\n      boxShadow: '0 4px 15px rgba(102, 126, 234, 0.4)',\n      transition: 'all 0.3s ease',\n      opacity: generating ? 0.7 : 1\n    },\n    children: generating ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '20px',\n          height: '20px',\n          border: '2px solid rgba(255,255,255,0.3)',\n          borderTop: '2px solid white',\n          borderRadius: '50%',\n          animation: 'spin 1s linear infinite'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 11\n      }, this), \"Generando recuerdo especial...\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 497,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontSize: '1.3rem'\n        },\n        children: \"\\uD83D\\uDCC4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Crear Recuerdo Especial\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 475,\n    columnNumber: 5\n  }, this);\n};\n_s(PDFGenerator, \"IZKZ4/5R9/VdhuI5+k+Ba4l0lxQ=\");\n_c = PDFGenerator;\nexport default PDFGenerator;\nvar _c;\n$RefreshReg$(_c, \"PDFGenerator\");","map":{"version":3,"names":["React","jsPDF","html2canvas","motion","jsxDEV","_jsxDEV","PDFGenerator","votos","estadisticas","treeRef","_s","generating","setGenering","useState","loadImage","src","Promise","resolve","reject","img","Image","crossOrigin","onload","onerror","createCircularImageDataUrl","size","canvas","document","createElement","ctx","getContext","scale","scaledSize","width","height","imageSmoothingEnabled","imageSmoothingQuality","clearRect","save","beginPath","arc","Math","PI","closePath","clip","imgAspect","drawWidth","drawHeight","offsetX","offsetY","drawImage","restore","toDataURL","error","console","log","truncateText","pdf","text","maxWidth","fontSize","setFontSize","textWidth","getTextWidth","truncated","length","slice","generatePDF","current","pageWidth","internal","pageSize","getWidth","pageHeight","getHeight","setFont","setFillColor","rect","setTextColor","align","treeCanvas","useCORS","allowTaint","backgroundColor","logging","offsetWidth","offsetHeight","treeImgData","treeAspectRatio","treeWidth","treeHeight","addImage","fecha","Date","toLocaleDateString","year","month","day","addPage","cardWidthStats","cardHeightStats","startX","setDrawColor","setLineWidth","roundedRect","total_votos","toString","votos_varon","votos_nina","porcentajeNino","round","porcentajeNina","circle","comentariosValidos","filter","voto","comentario","trim","marginX","marginY","cardWidth","cardHeight","cardSpacing","currentRow","currentCol","pageCount","index","_voto$nombre","currentY","cardX","cardY","pais","toLowerCase","nombreOffsetX","flagUrl","flagImg","e","nombreLimpio","nombre","anchoDisponible","nombreTruncado","prediccion","comentarioLimpio","lines","splitTextToSize","textHeight","startTextY","max","forEach","line","lineIndex","fechaTexto","raw","fecha_voto","f","isNaN","getTime","fechaVoto","horaVoto","toLocaleTimeString","hour","minute","foto_url","dataUrl","fotoX","fotoY","finalCardWidth","finalCardHeight","finalCardX","finalCardY","mensajeFinal","alert","button","onClick","disabled","whileHover","whileTap","style","background","color","border","borderRadius","padding","fontWeight","cursor","marginTop","boxShadow","transition","opacity","children","display","alignItems","justifyContent","gap","borderTop","animation","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/devdisnovo/Documentos/PROYECTOS/merci/client/src/components/PDFGenerator.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport { motion } from 'framer-motion';\n\ninterface PDFGeneratorProps {\n  votos: any[];\n  estadisticas: any;\n  treeRef: React.RefObject<HTMLDivElement>;\n}\n\nconst PDFGenerator: React.FC<PDFGeneratorProps> = ({ votos, estadisticas, treeRef }) => {\n  const [generating, setGenering] = React.useState(false);\n\n  // Utilidad: carga una imagen en alta resolución\n  const loadImage = (src: string): Promise<HTMLImageElement> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      img.onload = () => resolve(img);\n      img.onerror = reject;\n      img.src = src;\n    });\n  };\n\n  // Utilidad: crea una imagen circular de alta calidad\n  const createCircularImageDataUrl = async (src: string, size: number): Promise<string> => {\n    try {\n      const img = await loadImage(src);\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      \n      // Usar alta resolución para evitar pixelación\n      const scale = 2;\n      const scaledSize = size * scale;\n      canvas.width = scaledSize;\n      canvas.height = scaledSize;\n\n      if (!ctx) return '';\n\n      // Configurar para alta calidad\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = 'high';\n      \n      ctx.clearRect(0, 0, scaledSize, scaledSize);\n      ctx.save();\n      ctx.beginPath();\n      ctx.arc(scaledSize / 2, scaledSize / 2, scaledSize / 2, 0, Math.PI * 2, true);\n      ctx.closePath();\n      ctx.clip();\n\n      // Calcular dimensiones para mantener aspecto y llenar el círculo\n      const imgAspect = img.width / img.height;\n      let drawWidth = scaledSize;\n      let drawHeight = scaledSize;\n      let offsetX = 0;\n      let offsetY = 0;\n\n      if (imgAspect > 1) {\n        // Imagen más ancha que alta\n        drawHeight = scaledSize;\n        drawWidth = drawHeight * imgAspect;\n        offsetX = -(drawWidth - scaledSize) / 2;\n      } else {\n        // Imagen más alta que ancha\n        drawWidth = scaledSize;\n        drawHeight = drawWidth / imgAspect;\n        offsetY = -(drawHeight - scaledSize) / 2;\n      }\n\n      ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);\n      ctx.restore();\n\n      return canvas.toDataURL('image/png');\n    } catch (error) {\n      console.log('Error creating circular image:', error);\n      return '';\n    }\n  };\n\n  // Utilidad: truncar texto que no cabe en el ancho disponible\n  const truncateText = (pdf: jsPDF, text: string, maxWidth: number, fontSize: number): string => {\n    pdf.setFontSize(fontSize);\n    const textWidth = pdf.getTextWidth(text);\n    \n    if (textWidth <= maxWidth) {\n      return text;\n    }\n    \n    // Truncar y agregar \"...\"\n    let truncated = text;\n    while (pdf.getTextWidth(truncated + '...') > maxWidth && truncated.length > 1) {\n      truncated = truncated.slice(0, -1);\n    }\n    \n    return truncated + '...';\n  };\n\n  const generatePDF = async () => {\n    if (!treeRef.current) return;\n    \n    setGenering(true);\n    \n    try {\n      const pdf = new jsPDF('p', 'mm', 'a4');\n      const pageWidth = pdf.internal.pageSize.getWidth();\n      const pageHeight = pdf.internal.pageSize.getHeight();\n      \n      // Usar fuente Helvetica (más legible que la default)\n      pdf.setFont('helvetica');\n      \n      // Página 1: Portada con encabezado\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n      \n      // Encabezado principal con mejor tipografía\n      pdf.setFontSize(22);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('🌿 Árbol de Predicciones', pageWidth / 2, 25, { align: 'center' });\n      pdf.setFontSize(16);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Un Recuerdo Especial', pageWidth / 2, 35, { align: 'center' });\n      \n      // Capturar imagen del árbol en alta calidad\n      const treeCanvas = await html2canvas(treeRef.current, {\n        scale: 2, // Mayor escala para mejor calidad\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        logging: false,\n        width: treeRef.current.offsetWidth,\n        height: treeRef.current.offsetHeight\n      });\n      \n      const treeImgData = treeCanvas.toDataURL('image/png');\n      const treeAspectRatio = treeCanvas.width / treeCanvas.height;\n      const treeWidth = pageWidth - 40;\n      const treeHeight = treeWidth / treeAspectRatio;\n      \n      // Agregar imagen del árbol centrada\n      pdf.addImage(treeImgData, 'PNG', 20, 50, treeWidth, treeHeight);\n      \n      // Fecha de generación\n      pdf.setFontSize(12);\n      pdf.setTextColor(153, 153, 153);\n      pdf.setFont('helvetica', 'normal');\n      const fecha = new Date().toLocaleDateString('es-ES', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n      pdf.text(`Generado el ${fecha}`, pageWidth / 2, pageHeight - 20, { align: 'center' });\n      \n      // Página 2: Estadísticas en tarjetas modernas\n      pdf.addPage();\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n      \n      // Título de estadísticas\n      pdf.setFontSize(20);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('Estadísticas de las Predicciones', pageWidth / 2, 30, { align: 'center' });\n      \n      // Dibujar tarjetas de estadísticas modernas\n      const cardWidthStats = 55;\n      const cardHeightStats = 35;\n      const startX = (pageWidth - (cardWidthStats * 3 + 20)) / 2;\n      \n      // Tarjeta Total\n      pdf.setFillColor(255, 255, 255);\n      pdf.setDrawColor(230, 230, 230);\n      pdf.setLineWidth(0.5);\n      pdf.roundedRect(startX, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(102, 126, 234);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.total_votos.toString(), startX + cardWidthStats/2, 65, { align: 'center' });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Total Votos', startX + cardWidthStats/2, 75, { align: 'center' });\n      \n      // Tarjeta Niño\n      pdf.setFillColor(255, 255, 255);\n      pdf.roundedRect(startX + cardWidthStats + 10, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(30, 64, 175);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.votos_varon.toString(), startX + cardWidthStats + 10 + cardWidthStats/2, 65, { align: 'center' });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Niño', startX + cardWidthStats + 10 + cardWidthStats/2, 75, { align: 'center' });\n      \n      // Tarjeta Niña\n      pdf.setFillColor(255, 255, 255);\n      pdf.roundedRect(startX + (cardWidthStats + 10) * 2, 50, cardWidthStats, cardHeightStats, 8, 8, 'FD');\n      pdf.setTextColor(190, 24, 93);\n      pdf.setFontSize(18);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(estadisticas.votos_nina.toString(), startX + (cardWidthStats + 10) * 2 + cardWidthStats/2, 65, { align: 'center' });\n      pdf.setFontSize(10);\n      pdf.setTextColor(102, 102, 102);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text('Niña', startX + (cardWidthStats + 10) * 2 + cardWidthStats/2, 75, { align: 'center' });\n      \n      // Porcentajes en círculos pequeños\n      pdf.setFontSize(12);\n      const porcentajeNino = Math.round((estadisticas.votos_varon / estadisticas.total_votos) * 100);\n      const porcentajeNina = Math.round((estadisticas.votos_nina / estadisticas.total_votos) * 100);\n      \n      // Círculo para niño\n      pdf.setFillColor(212, 240, 247);\n      pdf.circle(startX + cardWidthStats + 10 + cardWidthStats/2, 90, 8, 'F');\n      pdf.setTextColor(30, 64, 175);\n      pdf.setFontSize(10);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text(`${porcentajeNino}%`, startX + cardWidthStats + 10 + cardWidthStats/2, 93, { align: 'center' });\n      \n      // Círculo para niña\n      pdf.setFillColor(250, 218, 221);\n      pdf.circle(startX + (cardWidthStats + 10) * 2 + cardWidthStats/2, 90, 8, 'F');\n      pdf.setTextColor(190, 24, 93);\n      pdf.text(`${porcentajeNina}%`, startX + (cardWidthStats + 10) * 2 + cardWidthStats/2, 93, { align: 'center' });\n      \n      // Filtrar comentarios válidos\n      const comentariosValidos = votos.filter(voto => \n        voto.comentario && \n        voto.comentario.trim().length > 0 && \n        voto.comentario.trim() !== 'undefined' &&\n        voto.comentario.trim() !== 'null'\n      );\n      \n      if (comentariosValidos.length > 0) {\n        // Página 3+: Comentarios en rejilla de 3 columnas\n        pdf.addPage();\n        pdf.setFillColor(248, 250, 252);\n        pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n        \n        // Título de la página\n        pdf.setFontSize(20);\n        pdf.setTextColor(51, 51, 51);\n        pdf.setFont('helvetica', 'bold');\n        pdf.text('Mensajes Especiales', pageWidth / 2, 25, { align: 'center' });\n        \n        // Configuración de la rejilla\n        const marginX = 15;\n        const marginY = 40;\n        const cardWidth = (pageWidth - (marginX * 2) - 20) / 3;\n        const cardHeight = 75;\n        const cardSpacing = 10;\n        \n        let currentRow = 0;\n        let currentCol = 0;\n        let pageCount = 3;\n        \n        for (let index = 0; index < comentariosValidos.length; index++) {\n          const voto = comentariosValidos[index];\n          \n          // Verificar si necesitamos nueva página\n          const currentY = marginY + (currentRow * (cardHeight + cardSpacing));\n          if (currentY + cardHeight > pageHeight - 30) {\n            pdf.addPage();\n            pdf.setFillColor(248, 250, 252);\n            pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n            pdf.setFontSize(20);\n            pdf.setTextColor(51, 51, 51);\n            pdf.setFont('helvetica', 'bold');\n            pdf.text(`Mensajes Especiales (Página ${pageCount})`, pageWidth / 2, 25, { align: 'center' });\n            currentRow = 0;\n            currentCol = 0;\n            pageCount++;\n          }\n          \n          const cardX = marginX + (currentCol * (cardWidth + 10));\n          const cardY = marginY + (currentRow * (cardHeight + cardSpacing));\n          \n          // Dibujar card con estilo moderno\n          pdf.setFillColor(255, 255, 255);\n          pdf.setDrawColor(230, 230, 230);\n          pdf.setLineWidth(0.5);\n          pdf.roundedRect(cardX, cardY, cardWidth, cardHeight, 8, 8, 'FD');\n          \n          // Agregar sombra sutil\n          pdf.setDrawColor(200, 200, 200);\n          pdf.setLineWidth(0.3);\n          pdf.roundedRect(cardX + 1, cardY + 1, cardWidth, cardHeight, 8, 8, 'S');\n          \n          // Bandera de alta calidad si hay país\n          const pais = (voto.pais || '').toString().toLowerCase();\n          let nombreOffsetX = 8;\n          if (pais && pais.length === 2) {\n            try {\n              // Usar URL de bandera de mayor resolución\n              const flagUrl = `https://flagcdn.com/48x36/${pais}.png`;\n              const flagImg = await loadImage(flagUrl);\n              // Tamaño ligeramente mayor para mejor calidad\n              pdf.addImage(flagImg, 'PNG', cardX + 8, cardY + 6, 14, 10.5);\n              nombreOffsetX = 8 + 14 + 4;\n            } catch (e) {\n              // Ignorar si falla la bandera\n            }\n          }\n          \n          // Limpiar y truncar el nombre si es muy largo\n          let nombreLimpio = voto.nombre?.toString().trim() || 'Anónimo';\n          if (nombreLimpio === 'undefined' || nombreLimpio === 'null') nombreLimpio = 'Anónimo';\n          \n          // Calcular ancho disponible para el nombre\n          const anchoDisponible = cardWidth - nombreOffsetX - 8;\n          const nombreTruncado = truncateText(pdf, nombreLimpio, anchoDisponible, 11);\n          \n          // Nombre\n          pdf.setFontSize(11);\n          pdf.setTextColor(51, 51, 51);\n          pdf.setFont('helvetica', 'bold');\n          pdf.text(nombreTruncado, cardX + nombreOffsetX, cardY + 12);\n          \n          // Etiqueta de género\n          pdf.setFontSize(9);\n          pdf.setFont('helvetica', 'normal');\n          if (voto.prediccion === 'varon') {\n            pdf.setFillColor(212, 240, 247);\n            pdf.roundedRect(cardX + 8, cardY + 20, 30, 8, 4, 4, 'F');\n            pdf.setTextColor(30, 64, 175);\n            pdf.text('👦 Niño', cardX + 10, cardY + 25);\n          } else {\n            pdf.setFillColor(250, 218, 221);\n            pdf.roundedRect(cardX + 8, cardY + 20, 30, 8, 4, 4, 'F');\n            pdf.setTextColor(190, 24, 93);\n            pdf.text('👧 Niña', cardX + 10, cardY + 25);\n          }\n          \n          // Comentario centrado\n          let comentarioLimpio = voto.comentario || 'Sin comentario';\n          comentarioLimpio = comentarioLimpio.toString().trim();\n          if (comentarioLimpio === 'undefined' || comentarioLimpio === 'null') comentarioLimpio = 'Sin comentario';\n          pdf.setFontSize(9);\n          pdf.setTextColor(55, 65, 81);\n          pdf.setFont('helvetica', 'normal');\n          const comentario = `\"${comentarioLimpio}\"`;\n          const lines = pdf.splitTextToSize(comentario, cardWidth - 20);\n          const textHeight = lines.length * 4;\n          const startTextY = cardY + 36 + Math.max(0, (cardHeight - 36 - textHeight - 12) / 2);\n          lines.forEach((line: string, lineIndex: number) => {\n            pdf.text(line, cardX + cardWidth / 2, startTextY + (lineIndex * 4), { align: 'center' });\n          });\n          \n          // Fecha inferior\n          pdf.setFontSize(8);\n          pdf.setTextColor(156, 163, 175);\n          let fechaTexto = 'Fecha no disponible';\n          try {\n            const raw = (voto.fecha_voto || voto.fecha || '').toString();\n            if (raw) {\n              const f = new Date(raw);\n              if (!isNaN(f.getTime())) {\n                const fechaVoto = f.toLocaleDateString('es-ES', { day: '2-digit', month: 'short', year: 'numeric' });\n                const horaVoto = f.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });\n                fechaTexto = `${fechaVoto}, ${horaVoto}`;\n              }\n            }\n          } catch {}\n          pdf.text(fechaTexto, cardX + 8, cardY + cardHeight - 6);\n          \n          // Foto circular de alta calidad\n          if (voto.foto_url) {\n            try {\n              const size = 22; // Ligeramente más grande\n              const dataUrl = await createCircularImageDataUrl(`http://192.168.18.49:5000${voto.foto_url}`, size * 2);\n              if (dataUrl) {\n                const fotoX = cardX + cardWidth - size - 6;\n                const fotoY = cardY + 6;\n                pdf.addImage(dataUrl, 'PNG', fotoX, fotoY, size, size);\n                // Borde circular\n                pdf.setDrawColor(230, 230, 230);\n                pdf.setLineWidth(0.5);\n                pdf.circle(fotoX + size/2, fotoY + size/2, size/2, 'S');\n              }\n            } catch {\n              // Placeholder más bonito\n              const size = 22;\n              const fotoX = cardX + cardWidth - size - 6;\n              const fotoY = cardY + 6;\n              pdf.setFillColor(243, 244, 246);\n              pdf.circle(fotoX + size/2, fotoY + size/2, size/2, 'F');\n              pdf.setDrawColor(209, 213, 219);\n              pdf.setLineWidth(0.5);\n              pdf.circle(fotoX + size/2, fotoY + size/2, size/2, 'S');\n              // Icono de usuario\n              pdf.setTextColor(156, 163, 175);\n              pdf.setFontSize(8);\n              pdf.text('👤', fotoX + size/2, fotoY + size/2 + 2, { align: 'center' });\n            }\n          }\n          \n          // Avanzar a la siguiente posición en la rejilla\n          currentCol++;\n          if (currentCol >= 3) {\n            currentCol = 0;\n            currentRow++;\n          }\n        }\n      }\n      \n      // Página final: Mensaje especial destacado\n      pdf.addPage();\n      pdf.setFillColor(248, 250, 252);\n      pdf.rect(0, 0, pageWidth, pageHeight, 'F');\n      \n      // Título principal\n      pdf.setFontSize(24);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('¡Felicidades Futuros Padres!', pageWidth / 2, 50, { align: 'center' });\n      \n      // Card destacada para el mensaje final\n      const finalCardWidth = pageWidth - 40;\n      const finalCardHeight = 120;\n      const finalCardX = 20;\n      const finalCardY = 70;\n      \n      // Fondo de la card\n      pdf.setFillColor(255, 255, 255);\n      pdf.setDrawColor(230, 230, 230);\n      pdf.setLineWidth(1);\n      pdf.roundedRect(finalCardX, finalCardY, finalCardWidth, finalCardHeight, 12, 12, 'FD');\n      \n      // Borde decorativo\n      pdf.setDrawColor(102, 126, 234);\n      pdf.setLineWidth(2);\n      pdf.roundedRect(finalCardX, finalCardY, finalCardWidth, finalCardHeight, 12, 12, 'S');\n      \n      // Mensaje final\n      pdf.setFontSize(14);\n      pdf.setTextColor(51, 51, 51);\n      pdf.setFont('helvetica', 'normal');\n      const mensajeFinal = [\n        'Este árbol representa el amor y las buenas vibras que',\n        'toda su familia y amigos tienen para ustedes.',\n        '',\n        'Cada hoja es una predicción llena de cariño y',\n        'esperanza para el nuevo miembro de la familia.',\n        '',\n        '¡Que este bebé traiga mucha alegría y bendiciones',\n        'a sus vidas!'\n      ];\n      mensajeFinal.forEach((line, index) => {\n        if (line.trim() !== '') {\n          pdf.text(line, pageWidth / 2, finalCardY + 25 + (index * 12), { align: 'center' });\n        }\n      });\n      \n      // Firma\n      pdf.setFontSize(12);\n      pdf.setTextColor(102, 126, 234);\n      pdf.setFont('helvetica', 'italic');\n      pdf.text('Con mucho amor y buenos deseos', pageWidth / 2, finalCardY + finalCardHeight + 20, { align: 'center' });\n      \n      // Guardar el PDF\n      pdf.save('arbol-predicciones-recuerdo-especial.pdf');\n      \n    } catch (error) {\n      console.error('Error generando PDF:', error);\n      alert('Error al generar el PDF. Inténtalo de nuevo.');\n    } finally {\n      setGenering(false);\n    }\n  };\n\n  return (\n    <motion.button\n      onClick={generatePDF}\n      disabled={generating}\n      whileHover={{ scale: 1.05 }}\n      whileTap={{ scale: 0.95 }}\n      style={{\n        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n        color: 'white',\n        border: 'none',\n        borderRadius: '15px',\n        padding: '18px 30px',\n        fontSize: '1.1rem',\n        fontWeight: '600',\n        cursor: generating ? 'not-allowed' : 'pointer',\n        width: '100%',\n        marginTop: '20px',\n        boxShadow: '0 4px 15px rgba(102, 126, 234, 0.4)',\n        transition: 'all 0.3s ease',\n        opacity: generating ? 0.7 : 1\n      }}\n    >\n      {generating ? (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px' }}>\n          <div style={{ \n            width: '20px', \n            height: '20px', \n            border: '2px solid rgba(255,255,255,0.3)', \n            borderTop: '2px solid white', \n            borderRadius: '50%', \n            animation: 'spin 1s linear infinite' \n          }} />\n          Generando recuerdo especial...\n        </div>\n      ) : (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px' }}>\n          <span style={{ fontSize: '1.3rem' }}>📄</span>\n          <span>Crear Recuerdo Especial</span>\n        </div>\n      )}\n    </motion.button>\n  );\n};\n\nexport default PDFGenerator; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}